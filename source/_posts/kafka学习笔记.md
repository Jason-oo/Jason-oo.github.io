---
title: kafka学习笔记
date: 2020-01-13 09:01:28
tags: middleware
category: 后端
---

> kafka是一个分布式流处理平台, 主要应用于流处理或消息队列. kafka作为一个集群运行在多台服务器上, 通过topic对存储的流数据进行分类, 每条记录中包含一个key、value和一个timestamp. 

### 概念

#### topics和日志

1. 多订阅者模式
2. partition分区, 每个分区都是有序且顺序不可变的记录集, 每个记录都会被分配一个id来表示顺序, 即常说的offset, 用来唯一标识分区中的每一条记录
3. 保留所有发布记录, 无论是否被消费. 可配置参数设置数据保留时长. kafka性能不受数据大小影响.
4. offset是消费者中唯一保存的元数据, 可随时反复读取kafka中的数据.

### 分布式
1. partiton分布在kafka集群服务器, 每个服务器共享这些分区, 每个分区在已配置的服务器上都有备份.
2. leader选举机制, 每个服务器都会成为某些分区的leader或某些分区的follower.

### 生产者
将数据发布到指定topic并负责将记录分配到指定partition

### 消费者
1. 订阅指定topic后消费消息, 使用**消费组**名称标识
2. 同组消费实例, 消息记录会负载平衡到每一个消费者实例, 即只有一个消费者实例会用来消费记录
3. 每条消息都会广播到所有的消费组

